name: Validate Markdown

on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]

jobs:
  validate:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Check for broken links
      uses: gaurav-nelson/github-action-markdown-link-check@v1
      with:
        use-quiet-mode: 'yes'
        config-file: '.github/markdown-link-check-config.json'
    
    - name: Validate markdown format
      run: |
        echo "Checking all markdown files exist..."
        test -f README.md
        test -f QUICK-REFERENCE.md
        test -f PRACTICE-CHECKLIST.md
        test -f CONTRIBUTING.md
        test -f LICENSE
        echo "✅ All required files exist"
    
    - name: Check case studies format
      run: |
        echo "Validating case studies follow 11-step format..."
        for file in case-studies/*.md; do
          echo "Checking $file..."
          grep -q "## 1. Problem Statement" "$file" || exit 1
          grep -q "## 2. Clarifying Questions" "$file" || exit 1
          grep -q "## 3. Requirements" "$file" || exit 1
          grep -q "## 11. Common Mistakes" "$file" || exit 1
        done
        echo "✅ All case studies follow the 11-step format"
